<UserControl x:Class="FrontLayer.Views.NewGoalView"
			 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 
			 xmlns:enums="clr-namespace:ModelLayer.Enums;assembly=ModelLayer"
			 xmlns:classes="clr-namespace:ModelLayer.Classes;assembly=ModelLayer"
			 xmlns:converter="clr-namespace:FrontLayer.Converters">
	
	<UserControl.Resources>
		<converter:ConverterNullToFalse x:Key="NullToFalseConverter"/>
		<converter:ConverterElementsToFalse x:Key="ElementsToFalseConverter"/>
		<converter:ConverterColorToSCB x:Key="ColorConverter"/>
	</UserControl.Resources>

	<StackPanel>
		<!-- ViewTitel -->
		<TextBlock Text="Neue Aufgabe!" Style="{StaticResource Title}"/>

		<!-- Gruppe Titel -->
		<TextBlock Text="Titel:"/>
		<TextBox x:Name="TextBox_Title" Text="{Binding Title, Mode=TwoWay}"/>

		<!-- Gruppe Beschreibung -->
		<TextBlock Text="Beschreibung:"/>
		<TextBox x:Name="TextBox_Beschreibung" Text="{Binding Description, Mode=TwoWay}"/>
		
		<!-- Gruppe Kategorie ComboBox -->
		<TextBlock Text="Kategorie:"/>
		<ComboBox x:Name="ComboBox_Category" 
				  ItemsSource="{Binding CategoryList}"
				  SelectedItem="{Binding SelectedCategory, Mode=TwoWay}">
			<ComboBox.ItemTemplate>
				<DataTemplate DataType="{x:Type classes:Category}">
					<StackPanel Orientation="Horizontal">
						<Ellipse Height="10" Width="10" Fill="{Binding Color, Converter={StaticResource ColorConverter}}"/>
						<TextBlock Text="{Binding Title}"/>
					</StackPanel>
				</DataTemplate>
			</ComboBox.ItemTemplate>
		</ComboBox>
		
		<!-- Gruppe Child ComboBox -->
		<TextBlock Text="Übergeordnete Aufgabe:"/>
		<ComboBox x:Name="ComboBox_Parent" 
				  ItemsSource="{Binding SelectedCategory.Children}"
				  SelectedItem="{Binding SelectedGoal, Mode=TwoWay}"
				  IsEnabled="{Binding ElementName=ComboBox_Category, Path=SelectedItem, Converter={StaticResource NullToFalseConverter}, Mode=OneWay}">
			<ComboBox.ItemTemplate>
				<HierarchicalDataTemplate DataType="{x:Type classes:Goal}"
										  ItemsSource="{Binding Children}">
					<TextBlock Text="{Binding Title}"/>
					<HierarchicalDataTemplate.ItemTemplate>
						<DataTemplate DataType="{x:Type classes:Goal}">
							<TextBlock Text="{Binding Title}"/>
						</DataTemplate>
					</HierarchicalDataTemplate.ItemTemplate>
				</HierarchicalDataTemplate>
			</ComboBox.ItemTemplate>
		</ComboBox>

		<!-- Gruppe Status ComboBox -->
		<TextBlock Text="Status:"/>
		<ComboBox x:Name="ComboBox_State"
				  ItemsSource="{Binding Source={enums:EnumBindingSource {x:Type enums:EnumState}}}"
				  SelectedItem="{Binding State, Mode=TwoWay}"/>

		<!-- Gruppe StartDatum DatePicker -->
		<TextBlock Text="Startdatum:"/>
		<DatePicker x:Name="DatePicker_StartDate" SelectedDate="{Binding StartDate, Mode=TwoWay}"/>
		
		<!-- Gruppe EndDatum DatePicker -->
		<TextBlock Text="Enddatum:"/>
		<DatePicker x:Name="DatePicker_EndDate" SelectedDate="{Binding EndDate, Mode=TwoWay}"/>

		<!-- Gruppe Speichern Button -->
		<Button Command="{Binding SaveGoalCommand}"
				Content="Speichern!"
				Margin="0,5">
			<Button.IsEnabled>
				<MultiBinding Converter="{StaticResource ElementsToFalseConverter}">
					<Binding ElementName="TextBox_Title" Path="Text"/>
					<Binding ElementName="ComboBox_Category" Path="SelectedItem" Converter="{StaticResource NullToFalseConverter}"/>
					<Binding ElementName="DatePicker_StartDate" Path="SelectedDate" Converter="{StaticResource NullToFalseConverter}"/>
					<Binding ElementName="DatePicker_EndDate" Path="SelectedDate" Converter="{StaticResource NullToFalseConverter}"/>
				</MultiBinding>
			</Button.IsEnabled>
		</Button>

	</StackPanel>

</UserControl>
